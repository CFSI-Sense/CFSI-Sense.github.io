<!DOCTYPE html>
<html>
var viz, workbook;

window.onload= function() {
	var vizDiv = document.getElementById('viz');
	var vizURL = "http://public.tableausoftware.com/views/Presents/TreeMap";
	var options = {
		width: '600px',
		height: '540px',
		hideToolbar: true,
		hideTabs: true,
		onFirstInteractive: function () {
			workbook = viz.getWorkbook();
			document.getElementById('sheetName').innerHTML = viz.getWorkbook().getActiveSheet().getName();
		}
	};
	viz = new tableauSoftware.Viz(vizDiv, vizURL, options);
	viz.addEventListener('tabswitch', function(event) {
		document.getElementById('sheetName').innerHTML = event.getNewSheetName();
	});
};

function exportPDF() {
	viz.showExportPDFDialog();
}

function exportData() {
	viz.showExportDataDialog();
}

function exportWorkbook() {
	viz.showDownloadWorkbookDialog();
}

function exportImage() {
	viz.showExportImageDialog();
}

</html>
